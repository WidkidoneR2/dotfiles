---
id: 046
date: 2026-01-14
type: future
title: "v7.0.0 - Architectural Refactor"
status: planned
tags: [architecture, v7.0, breaking-changes, faelight-core]
---

## Vision

Unified architecture for all Faelight tools with shared foundation.

**Goals:**
- Eliminate duplication across 9 Rust tools
- 70%+ performance gain through shared optimizations
- Enable future tools with proven patterns
- Beat waybar (bar), walker (launcher), mako (notify) in design quality

**Breaking Changes Allowed:** v7.0.0 permits breaking changes to achieve architectural goals.

---

## The Scope

### Phase 1: Foundation (Week 1-2)
**Intent 047: faelight-core - Shared Foundation Library**
- Glyph cache (all tools render text)
- TOML configuration parsing
- External command hygiene + timeouts
- Wayland boilerplate

**Intent 036: Rust Hygiene - Code Quality Improvements**
- Replace `.unwrap()` with `?` operator
- Add `clap` for CLI parsing
- Add `health_check()` to all tools
- Unit tests where valuable

### Phase 2: Tool Refactors (Week 2-3)

**Intent 050: faelight-bar v2.0 - Architectural Refactor**
- Cached model (data collection â†’ rendering split)
- JSON parsing (Sway IPC)
- Semantic click handling
- Module-level update frequencies
- Visual polish (underlines, animations, icons)

**Intent 037: Notification Intelligence**
- Severity levels: INFO, WARN, CRIT
- Source trust hierarchy
- Notification history TUI
- Actionable buttons
- Event correlation

**Intent 049 + 038: faelight-launcher v2.0**
- Provider architecture (apps, commands, intents, docs)
- Frecency tracking
- Command mode (>, /, @)
- Inline preview panel

### Phase 3: Migration (Week 3-4)

**Intent 048: Tool Migrations to faelight-core**
- Migrate faelight-bar
- Migrate faelight-notify
- Migrate faelight-launcher
- Migrate faelight-menu
- Migrate faelight-lock
- Update build system

---

## Success Criteria

**Must Have:**
- [ ] faelight-core v0.1.0 shipped
- [ ] All 9 tools migrated to faelight-core
- [ ] Measurable performance gains (benchmarks)
- [ ] faelight-bar v2.0 with cached model
- [ ] faelight-launcher v2.0 with providers
- [ ] faelight-notify v2.0 with intelligence
- [ ] 100% health maintained throughout
- [ ] Zero regressions in functionality

**Nice to Have:**
- [ ] Beat waybar in performance benchmarks
- [ ] Beat walker in launcher features
- [ ] Beat mako in notification design
- [ ] Man pages for all tools

**Quality Bar:**
- [ ] All changes documented in intents
- [ ] Each phase tested independently
- [ ] Rollback path for each migration

---

## Philosophy Validation

**Does this advance 0-Core principles?**

âœ… **Manual Control:** Provider architecture enables choice  
âœ… **Understanding:** Explainable ranking, typed configs  
âœ… **Safety:** Confirmation + risk integration  
âœ… **Performance:** Glyph cache = respect for resources  
âœ… **Recovery:** Migrations happen one tool at a time  

**Red Flags to Watch:**
âŒ Abstraction without clarity  
âŒ Performance without proof  
âŒ Complexity without benefit  

---

## Timeline

**Estimated: 3-4 weeks**
- Week 1: faelight-core foundation + Rust hygiene
- Week 2: Bar + notify refactors
- Week 3: Launcher v2.0
- Week 4: Final migrations + polish

**Note:** Working > Perfect. Ship incrementally.

---

## Related Intents

- Intent 036: Rust Hygiene
- Intent 037: Notification Intelligence
- Intent 038: Launcher as Command Brain
- Intent 047: faelight-core
- Intent 048: Tool Migrations
- Intent 049: Launcher v2.0 Provider Architecture
- Intent 050: faelight-bar v2.0 Architectural Refactor

---

_"Foundation before features. Architecture before polish."_ ðŸŒ²
