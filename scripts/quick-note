#!/usr/bin/env fish
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“ Quick Note - Daily Scratchpad for Faelight Forest
# Opens today's note file for quick thoughts, todos, ideas
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Configuration
set NOTES_DIR ~/notes
set EDITOR nvim

# Colors
set COLOR_PRIMARY "5bb7a5"
set COLOR_SECONDARY "8ed1a3"
set COLOR_ACCENT "c7df63"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“ SETUP
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Create notes directory if it doesn't exist
if not test -d $NOTES_DIR
    mkdir -p $NOTES_DIR
    set_color -o $COLOR_PRIMARY
    echo "ğŸ“ Created notes directory: $NOTES_DIR"
    set_color normal
end

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“… DETERMINE NOTE FILE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Get today's date
set TODAY (date +"%Y-%m-%d")
set DISPLAY_DATE (date +"%A, %B %d, %Y")
set NOTE_FILE "$NOTES_DIR/$TODAY-notes.md"

# Check if note already exists
set IS_NEW false
if not test -f $NOTE_FILE
    set IS_NEW true
end

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“ CREATE NEW NOTE TEMPLATE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if test "$IS_NEW" = "true"
    # Create note with template
    echo "# ğŸ“ Daily Notes - $DISPLAY_DATE" > $NOTE_FILE
    echo "" >> $NOTE_FILE
    echo "## âœ… Tasks" >> $NOTE_FILE
    echo "" >> $NOTE_FILE
    echo "- [ ] " >> $NOTE_FILE
    echo "" >> $NOTE_FILE
    echo "## ğŸ’¡ Ideas" >> $NOTE_FILE
    echo "" >> $NOTE_FILE
    echo "- " >> $NOTE_FILE
    echo "" >> $NOTE_FILE
    echo "## ğŸ“Œ Quick Notes" >> $NOTE_FILE
    echo "" >> $NOTE_FILE
    echo "" >> $NOTE_FILE
    echo "" >> $NOTE_FILE
    echo "## ğŸ”— Links" >> $NOTE_FILE
    echo "" >> $NOTE_FILE
    echo "- " >> $NOTE_FILE
    echo "" >> $NOTE_FILE
    echo "---" >> $NOTE_FILE
    echo "" >> $NOTE_FILE
    echo "*Created: $(date +"%I:%M %p")*" >> $NOTE_FILE
    
    set_color -o $COLOR_PRIMARY
    echo "ğŸ“ Created new note: $TODAY-notes.md"
    set_color normal
else
    set_color -o $COLOR_SECONDARY
    echo "ğŸ“ Opening existing note: $TODAY-notes.md"
    set_color normal
end

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ¨ SHOW HEADER
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo ""
set_color -o $COLOR_ACCENT
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘           ğŸ“ QUICK NOTE - FAELIGHT FOREST               â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
set_color normal
echo ""
set_color $COLOR_SECONDARY
echo "Date: $DISPLAY_DATE"
echo "File: $NOTE_FILE"
set_color normal
echo ""

# Show recent notes
set_color $COLOR_PRIMARY
echo "ğŸ“š Recent Notes:"
set_color normal
ls -t $NOTES_DIR/*.md 2>/dev/null | head -5 | while read note
    set note_date (basename $note .md | sed 's/-notes//')
    echo "  â€¢ $note_date"
end
echo ""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸš€ OPEN NOTE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Optional: Add timestamp separator if note exists
if test "$IS_NEW" = "false"
    echo "" >> $NOTE_FILE
    echo "---" >> $NOTE_FILE
    echo "" >> $NOTE_FILE
    echo "### Update: $(date +"%I:%M %p")" >> $NOTE_FILE
    echo "" >> $NOTE_FILE
end

# Open in editor
set_color -o $COLOR_PRIMARY
echo "ğŸš€ Opening in $EDITOR..."
set_color normal
echo ""

$EDITOR $NOTE_FILE

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# âœ… DONE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

echo ""
set_color -o "5bb77a"
echo "âœ… Note saved!"
set_color normal

# Show word count
if test -f $NOTE_FILE
    set word_count (wc -w < $NOTE_FILE)
    echo "ğŸ“Š Word count: $word_count"
end

echo ""
set_color $COLOR_SECONDARY
echo "ğŸ’¡ Tips:"
echo "  â€¢ View all notes: ls $NOTES_DIR"
echo "  â€¢ Search notes: grep -r 'keyword' $NOTES_DIR"
echo "  â€¢ Open yesterday: quick-note (edit script for --yesterday)"
set_color normal
echo ""
