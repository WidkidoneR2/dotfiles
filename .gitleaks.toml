title = "Faelight Forest Gitleaks Config"

[extend]
useDefault = true

# ═══════════════════════════════════════════════════════════
# Custom Rules - Modern Tokens & Secrets
# ═══════════════════════════════════════════════════════════

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api_key|apikey|api-key|secret_key|secretkey|secret-key)\s*[:=]\s*['"]?[0-9a-zA-Z\-_]{16,}['"]?'''

[[rules]]
id = "password-in-config"
description = "Password in Config"
regex = '''(?i)(password|passwd|pwd)\s*[:=]\s*['"][^'"]{3,}['"]'''

[[rules]]
id = "github-token"
description = "GitHub Classic Token"
regex = '''ghp_[0-9a-zA-Z]{36}'''

[[rules]]
id = "github-fine-grained-token"
description = "GitHub Fine-Grained Token"
regex = '''github_pat_[0-9a-zA-Z_]{82}'''

[[rules]]
id = "gitlab-token"
description = "GitLab Personal Access Token"
regex = '''glpat-[0-9a-zA-Z\-_]{20}'''

[[rules]]
id = "aws-access-key"
description = "AWS Access Key"
regex = '''AKIA[0-9A-Z]{16}'''

[[rules]]
id = "slack-token"
description = "Slack Token"
regex = '''xox[baprs]-[0-9a-zA-Z\-]{10,}'''

[[rules]]
id = "discord-bot-token"
description = "Discord Bot Token"
regex = '''[MN][A-Za-z\d]{23}\.[\w-]{6}\.[\w-]{27}'''

[[rules]]
id = "private-key"
description = "Private Key"
regex = '''-----BEGIN (RSA|DSA|EC|OPENSSH) PRIVATE KEY-----'''

[[rules]]
id = "high-entropy-string"
description = "High Entropy String (potential secret)"
regex = '''['"][0-9a-zA-Z\-_]{32,}['"]'''
entropy = 4.5
secretGroup = 0

# ═══════════════════════════════════════════════════════════
# Allowlist - Safe to Commit
# ═══════════════════════════════════════════════════════════

[allowlist]
description = "Files safe to commit"
paths = [
    '''.gitleaks.toml''',
    '''docs/''',
    '''README.md''',
    '''CHANGELOG.md''',
    '''INTENT/''',
    '''\.pub$''',              # SSH public keys
    '''_test\.rs$''',          # Rust test files
    '''tests/fixtures/''',     # Test data
]

regexes = [
    '''(example|sample|test|fake|dummy)''',  # Obvious test values
]
